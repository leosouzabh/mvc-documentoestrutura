{"version":3,"sources":["../../app-es6/service/NovoItemService.js"],"names":["NovoItemService","idListagem","_idListagem","_idContainer","novoItem","_clonaItem","_alteraNumeroSequencial","_limpaItensEmListagens","_limpaValoresEmInputs","_alteraIdsChildren","$","append","idItemRef","clone","totalFilho","_getTotalItens","children","find","text","listagensChildren","length","each","idx","listagem","itensListagemChildren","id","idx2","itemDaListagem","remove","idOriginal","data","fragIdOriginal","fragNovoId","_doUpdateIds","listaItens","item","attr","replace","dataId","console","log","val"],"mappings":"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","file":"NovoItemService.js","sourcesContent":["import {TextoBuilder}     from '../builder/html/TextoBuilder';\r\nimport {ListaBuilder}  from '../builder/html/ListaBuilder';\r\nimport {DataBuilder}  from '../builder/html/DataBuilder';\r\nimport {NumeroBuilder}  from '../builder/html/NumeroBuilder';\r\nimport {MoedaBuilder}  from '../builder/html/MoedaBuilder';\r\n\r\n\r\nexport class NovoItemService {\r\n    \r\n    constructor(idListagem){\r\n        this._idListagem = idListagem;\r\n        this._idContainer = `#container-${idListagem}`;\r\n    }\r\n\r\n\r\n    geraNovoItem(){\r\n        let novoItem = this._clonaItem();\r\n        \r\n        this._alteraNumeroSequencial(novoItem);\r\n        this._limpaItensEmListagens(novoItem);\r\n        this._limpaValoresEmInputs(novoItem);\r\n        this._alteraIdsChildren(novoItem);\r\n        \r\n        $(this._idContainer).append(novoItem);        \r\n    }\r\n\r\n\r\n    _clonaItem(){\r\n        let idItemRef = `#wrapitem-${this._idListagem}-0`;\r\n        return $(idItemRef).clone();\r\n    }\r\n\r\n\r\n    _alteraNumeroSequencial(novoItem){\r\n        let totalFilho = this._getTotalItens();\r\n        $(novoItem.children()[0]).find(\".indice-item\").text(`#${totalFilho+1}`);\r\n    }\r\n\r\n\r\n    _limpaItensEmListagens(novoItem){\r\n        let listagensChildren = novoItem.find(\".listagem\");\r\n        if (listagensChildren.length > 0){\r\n            $.each(listagensChildren, (idx, listagem)=>{\r\n                let itensListagemChildren = $(listagem).find(`#container-${listagem.id}`).children();\r\n                $.each(itensListagemChildren, (idx2, itemDaListagem)=> {if (idx2 > 0) itemDaListagem.remove()} );\r\n            });\r\n        }\r\n    }\r\n\r\n\r\n    _alteraIdsChildren(novoItem){\r\n        let idOriginal = $(`#${this._idListagem}`).data('id');\r\n        let fragIdOriginal = `0-${idOriginal}`;\r\n        let fragNovoId = `${this._getTotalItens()}-${idOriginal}`;\r\n        \r\n        this._doUpdateIds([novoItem], fragIdOriginal, fragNovoId);\r\n    }\r\n    _doUpdateIds(listaItens, fragIdOriginal, fragNovoId){\r\n        $.each(listaItens, (idx, item)=>{            \r\n            let id = $(item).attr('id');\r\n            if (id){\r\n                $(item).attr('id', id.replace(fragIdOriginal, fragNovoId));\r\n            }\r\n            \r\n            let dataId = $(item).data('id-listagem');\r\n            if (dataId){\r\n                console.log('alterou data');\r\n                $(item).data('id-listagem', dataId.replace(fragIdOriginal, fragNovoId))\r\n            }\r\n            \r\n            if ($(item).children().length > 0){\r\n                this._doUpdateIds($(item).children(), fragIdOriginal, fragNovoId);\r\n            }\r\n        })\r\n    }\r\n    \r\n\r\n\r\n    _limpaValoresEmInputs(novoItem){\r\n        novoItem.find(\"input.form-control\").val(\"\");\r\n    }\r\n\r\n\r\n    _getTotalItens(){\r\n        return $(this._idContainer).children().length;\r\n    }\r\n    \r\n}"]}